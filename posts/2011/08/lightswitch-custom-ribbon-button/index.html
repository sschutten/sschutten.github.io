<!doctype html><html><head><title>Lightswitch: custom ribbon button</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><link rel=icon type=image/png href=/images/favicon_hu71cff7c6f06c0ce56c441b69c0864ea6_5216_42x0_resize_box_3.png><link rel=stylesheet href=/css/style.css><meta name=description content="Lightswitch: custom ribbon button"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-xxxxxxxx","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/main-logo_hu71cff7c6f06c0ce56c441b69c0864ea6_5216_42x0_resize_box_3.png alt=Logo>Sander Schutten's Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div><img src=/images/main-logo_hu71cff7c6f06c0ce56c441b69c0864ea6_5216_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/inverted-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=https://sschutten.github.io/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-plus-circle"></i><a href=/posts/2019/>2019</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2019/10/>October</a><ul><li><a href=/posts/2019/10/difference-between-apply-to-each-and-for-each-actions/>Difference between Apply to each and For each actions</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2019/09/>September</a><ul><li><a href=/posts/2019/09/intelligent-digital-assitants/>Intelligent chatbots for Microsoft Teams</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2019/08/>August</a><ul><li><a href=/posts/2019/08/edge-multi-profile-with-custom-images/>Custom profile images in Edge</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2018/>2018</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2018/02/>February</a><ul><li><a href=/posts/2018/02/logic-apps-improvement-suggestions/>Logic Apps improvement suggestions</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2018/12/>December</a><ul><li><a href=/posts/2018/12/connect-azure-ad-authenticated-signalr-hub-from-spfx/>Connect to Azure AD secured SignalR Hub from your SPFx code</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2017/>2017</a><ul><li><a href=/posts/2017/11/>November</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2013/>2013</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2013/06/>June</a><ul><li><a href=/posts/2013/06/move-your-development-vm-to-azure/>Move your development VM to Azure</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2012/>2012</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2012/09/>September</a><ul><li><a href=/posts/2012/09/preparing-for-70-484-essentials-of-developing-windows-metro-style-apps-using-c/>Preparing for 70-484: Essentials of Developing Windows Metro style Apps using C#</a></li><li><a href=/posts/2012/09/preparing-for-70-485-advanced-metro-style-app-development-using-c/>Preparing for 70-485: Advanced Metro style App Development using C#</a></li></ul></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/2011/>2011</a><ul class=active><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/2011/08/>August</a><ul class=active><li><a class=active href=/posts/2011/08/lightswitch-custom-ribbon-button/>Lightswitch: custom ribbon button</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2011/07/>July</a><ul><li><a href=/posts/2011/07/windows-phone-7-mango-features/>Windows Phone 7 Mango features</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2011/04/>April</a><ul><li><a href=/posts/2011/04/mix11-boot-camps/>MIX11: Boot Camps</a></li><li><a href=/posts/2011/04/mix11-day-1/>MIX11: Day 1</a></li><li><a href=/posts/2011/04/mix11-day-2/>MIX11: Day 2</a></li><li><a href=/posts/2011/04/mix11-day-3/>MIX11: Day 3</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2011/03/>March</a><ul><li><a href=/posts/2011/03/advanced-mvvm-doing-visual-states-properly/>Advanced MVVM: Doing visual states properly</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2011/01/>January</a><ul><li><a href=/posts/2011/01/using-the-sync-framework-on-windows-phone-7/>Using the Sync Framework on Windows Phone 7</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2010/>2010</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2010/11/>November</a><ul><li><a href=/posts/2010/11/wcf-ria-services-odata-endpoint-does-not-support-update-or-linq/>WCF RIA Services OData endpoint does NOT support update or LINQ</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2010/12/>December</a><ul><li><a href=/posts/2010/12/building-a-location-aware-windows-phone-7-application-2/>Building a location aware Windows Phone 7 application</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2009/>2009</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2009/01/>January</a><ul><li><a href=/posts/2009/01/mce-guide-editor-source-code/>MCE Guide Editor source code</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2008/>2008</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2008/11/>November</a><ul><li><a href=/posts/2008/11/building-vista-media-center-add-ins-dutch/>Building Vista Media Center Add-ins (Dutch)</a></li><li><a href=/posts/2008/11/honk-twice-if-you-see-us/>Honk twice if you see us!</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2008/10/>October</a><ul><li><a href=/posts/2008/10/better-wssf-solution-structure/>Better WSSF solution structure</a></li><li><a href=/posts/2008/10/consume-wcf-service-using-sharepoint-designer/>Consume WCF service using Sharepoint Designer</a></li><li><a href=/posts/2008/10/day-0-arrived-in-la/>Day 0: arrived in LA</a></li></ul></li><li><a href=/posts/2008/09/>September</a></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2008/08/>August</a><ul><li><a href=/posts/2008/08/first-release-of-viddlernet/>First release of Viddler.Net</a></li><li><a href=/posts/2008/08/viddlernet-on-codeplex/>Viddler.Net on Codeplex</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2008/07/>July</a><ul><li><a href=/posts/2008/07/biztalk-server-capabilities-poster/>BizTalk Server capabilities poster</a></li><li><a href=/posts/2008/07/bizunit-designer/>BizUnit Designer</a></li><li><a href=/posts/2008/07/control-windows-media-center-with-new-windows-sideshow-beta-gadgets/>Control Windows Media Center with New Windows SideShow BETA Gadgets</a></li><li><a href=/posts/2008/07/ext-js/>Ext JS</a></li><li><a href=/posts/2008/07/farpoint-spread-for-biztalk-server-2006/>FarPoint Spread for BizTalk Server 2006</a></li><li><a href=/posts/2008/07/first-look-at-wcf-adapter-for-biztalk-server-2006-r2/>First look at WCF Adapter for BizTalk Server 2006 R2</a></li><li><a href=/posts/2008/07/86/>Home Server campaign</a></li><li><a href=/posts/2008/07/84/>How-To: New ASP.NET 3.5 Extensions Video Screencasts</a></li><li><a href=/posts/2008/07/map-xsstring-to-xsdatetime/>Map xs:string to xs:datetime</a></li><li><a href=/posts/2008/07/microsoft-biztalk-server-performance-optimization-guide/>Microsoft BizTalk Server Performance Optimization Guide</a></li><li><a href=/posts/2008/07/microsoft-loadgen-2007/>Microsoft LoadGen 2007</a></li><li><a href=/posts/2008/07/more-biztalk-posters/>More BizTalk posters</a></li><li><a href=/posts/2008/07/released-biztalk-server-2006-extentions-for-wf/>Released: BizTalk Server 2006 extentions for WF</a></li><li><a href=/posts/2008/07/video-biztalk-services-explained/>Video: BizTalk Services Explained</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2008/04/>April</a><ul><li><a href=/posts/2008/04/biztalk-server-2006-r3-just-around-the-corner/>BizTalk Server 2006 R3 just around the corner</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2008/03/>March</a><ul><li><a href=/posts/2008/03/status-update-on-mce-guide-editor/>Status update on MCE Guide Editor</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2008/02/>February</a><ul><li><a href=/posts/2008/02/jonas-butt-the-new-it-talent/>Jonas Butt, the new IT-talent?</a></li><li><a href=/posts/2008/02/63/>Running</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2007/>2007</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2007/06/>June</a><ul><li><a href=/posts/2007/06/devdays-2007-were-you-there/>DevDays 2007, were you there?</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2007/05/>May</a><ul><li><a href=/posts/2007/05/first-release-of-mce-guide-editor/>First release of MCE Guide Editor</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2007/02/>February</a><ul><li><a href=/posts/2007/02/net-magazine-article-published-online/>.Net Magazine article published online</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2007/01/>January</a><ul><li><a href=/posts/2007/01/accessing-flat-file-content-in-orchestration/>Accessing flat file content in orchestration</a></li><li><a href=/posts/2007/01/biztalk-adapter-whitepaper/>BizTalk Adapter whitepaper</a></li><li><a href=/posts/2007/01/biztalk-shell-extension/>BizTalk shell extension</a></li><li><a href=/posts/2007/01/biztalk-troubleshooting-guide/>BizTalk Troubleshooting Guide</a></li><li><a href=/posts/2007/01/mcts-biztalk-server-2006/>MCTS BizTalk Server 2006</a></li><li><a href=/posts/2007/01/pipeline-testing-framework-for-bts06/>Pipeline Testing Framework for BTS06</a></li><li><a href=/posts/2007/01/playing-blog-tag/>Playing Blog-Tag</a></li><li><a href=/posts/2007/01/storing-configuration-inside-sso-database/>Storing configuration inside SSO database</a></li><li><a href=/posts/2007/01/using-bam-api-to-create-related-activities/>Using BAM API to create related activities</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2006/>2006</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2006/11/>November</a><ul><li><a href=/posts/2006/11/add-existing-project-from-web-drama/>Add existing project from web drama</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2006/03/>March</a><ul><li><a href=/posts/2006/03/developing-for-vista-media-center/>Developing for Vista Media Center</a></li><li><a href=/posts/2006/03/html-generator-stylesheet-for-biztalk-2004-maps/>HTML Generator Stylesheet for BizTalk 2004 Maps</a></li><li><a href=/posts/2006/03/increase-xslt-performance-by-using-xlskey/>Increase XSLT performance by using xls:key</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2006/02/>February</a><ul><li><a href=/posts/2006/02/biztalk-load-generation-utility-reloaded/>BizTalk Load Generation Utility reloaded</a></li><li><a href=/posts/2006/02/biztalk-performance-tester-released/>BizTalk Performance Tester released</a></li><li><a href=/posts/2006/02/devdays-7-8-march/>DevDays 7 &amp;amp; 8 March</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2006/01/>January</a><ul><li><a href=/posts/2006/01/happy-new-year/>Happy new year!</a></li><li><a href=/posts/2006/01/identify-node-type-in-xslt/>Identify node type in XSLT</a></li><li><a href=/posts/2006/01/suppress-xml-documentation-warnings-for-a-project/>Suppress XML documentation warnings for a project</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2005/>2005</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2005/11/>November</a><ul><li><a href=/posts/2005/11/access-message-properties-inside-custom-pipeline-component/>Access message properties inside custom pipeline component</a></li><li><a href=/posts/2005/11/biztalk-server-2006-ctm-released/>BizTalk Server 2006 CTM Released</a></li><li><a href=/posts/2005/11/biztalks-sexy-new-xslt-mapper/>BizTalk&amp;#039;s sexy new XSLT mapper</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2005/10/>October</a><ul><li><a href=/posts/2005/10/biztalk-2006-beta-1/>BizTalk 2006 Beta 1</a></li><li><a href=/posts/2005/10/bizunit-20-released/>BizUnit 2.0 released</a></li><li><a href=/posts/2005/10/joining-the-overloaded-web-log-community/>Joining the overloaded web-log community</a></li><li><a href=/posts/2005/10/workflow-designer-will-substitute-orchestration-designer-in-biztalk-vnext/>Workflow designer will substitute orchestration designer in BizTalk vNext</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2005/12/>December</a><ul><li><a href=/posts/2005/12/load-xmlschemas-from-biztalk-assembly/>Load XmlSchema&amp;#039;s from BizTalk assembly</a></li></ul></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://sschutten.github.io/images/default-hero.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/avatar.jpg alt="Author Image"><h5 class=author-name>Sander Schutten</h5><p>August 10, 2011</p></div><div class=title><h1>Lightswitch: custom ribbon button</h1></div><div class=post-content id=post-content><p>Two weeks ago, on July 26th, Visual Studio Lightswitch 2011 was released. I ‘d seen a couple of videos what you can do with Lightswitch so I though I’d put it to the test by developing a replacement for a tool I use at one of my clients. Lightswitch is really easy to use and I believe I can actually teach my wife to create data-centric application using it. Until you reach the limits though, because than it becomes more difficult really fast. The main reason for this is that there’s not much documentation available on the inner workings of Lightswitch and how to hook into some of it. One of the things I ran into was how to add my own button to the ribbon that is available on every screen, like the default Save and Refresh buttons are (unless you explicitly set them not to be visible on a screen).</p><h2 id=extending-lightswitch-applications>Extending Lightswitch applications</h2><p>Like with many things, if you know how to do it, it’s not that hard. Lightswitch makes heavy use of the Managed Extensibility Framework, MEF. To extend the default behavior of Lightswitch you need to implement certain interfaces and export your implementation using the MEF Export attribute. There are multiple places your extension could live:</p><ul><li>A Lightswitch Extensibility solution</li><li>A Silverlight class library</li><li>In the Lightswitch application itself</li></ul><p>The Microsoft preferred place if the Lightswitch Extensibility solution, but I believe that’s overkill if you just want a button specific to the application you’re building. The Lightswitch Extensibility solution is a perfect way to build extensions for Lightswitch that you want to reuse for multiple applications, e.g. a certain shell style of theme for the company you work for. To create a Lightswitch Extensibility solution, you need to have the Lightswitch Extensibility Toolkit, available <a href=http://msdn.microsoft.com/en-us/lightswitch/hh304488>here</a>. Note that you also need Visual Studio 2010 Pro and the Visual Studio 2010 SP1 SDK in order to use the toolkit.</p><p>The Silverlight class library is a good option if you have extensions specific to your application. It works the same way as extensions in the Lightswitch application itself, but makes for a better separation of generated and custom code.</p><p>The last option is good if you want a quick extension to your application. In this example I use this method because it’s the easiest to demonstrate how it works and allows to focus on the task at hand: adding a button to the ribbon that is available on all screens.</p><h3 id=heading></h3><h2 id=adding-a-class-file-to-the-lighswitch-application>Adding a class file to the Lighswitch application</h2><p>It may sound easy to add a class file to the Lightswitch application, but if you don’t know how to do it, it can be quite a challenge. The thing is that a Lightswitch application behaves differently in Visual Studio. It isn’t a normal project with class files, folders and custom controls. It’s a logical view of your application that hides all the generated code from you. But there’s a way to switch to the view which does show the various projects and files that make up your application. In the button strip on the top of your solution explorer, there’s a button on the far right that allows you to toggle between the logical and the file views.</p><p><a href=images/image3.png><img src=images/image3.png alt=image title=image></a></p><p>Once you switched to the file view, you see your application is made up by a Client, Common and Server project, where the Client project contains your Silverlight app, the Server project contains all server related stuff like data access and the Common project contains the things shared between the Client and Server project. You can go one step further by choosing to show all files. This is also a button on the button strip on top of your solution explorer. If you toggle to show all files, you also get to see the ClientGenerated and ServerGenerated projects. This is used for example if you need to change a connection string in the web.config, which is located in the ServerGenerated project.</p><p><a href=images/image4.png><img src=images/image4.png alt=image title=image></a></p><p>Since the button needs to be added to the Silverlight client, this is where we add the class file. Right click the Client project and choose to add a class. Name it MyGroupProvider.cs. I’ll explain later why we call it a provider.</p><h2 id=steps-to-add-a-custom-button>Steps to add a custom button</h2><p>Adding a custom button to the ribbon that is available on all screens involves the following steps:</p><ul><li>Create a class that implements <code>IExecutable</code> for executing code when the button is clicked</li><li>Create a class that implements <code>IShellCommand</code> which is our button</li><li>Create a class that implements <code>IShellCommandGroup</code> which is the group for the button</li><li>Create a class that implements <code>IShellCommandGroupProvider</code> that acts as the provider for MEF so Lightswitch can find our button.</li></ul><h2 id=implement-iexecutable>Implement IExecutable</h2><p>The class that implements <code>IExecutable</code> is responsible for executing code when the button is clicked. This interface could be compare to the Silverlight ICommand interface but with some editions. The interface provides properties through which Lightswitch determines if the executable can be executed and methods for executing the code. In addition to the <code>ICommand</code> interface, the <code>IExecutable</code> interface allows for synchronous and asynchronous execution, allows cancellation of an asynchronous execution and provides a way to handle errors with the execution.</p><p>Create a class named MyExecutableObject and implement <code>IExecutable</code>. For the executable to work in the ribbon, you need to change the CanExecuteAsync to return true and implement ExecuteAsync to execute the code you want, e.g. showing a screen. The synchronous CanExecute property and Execute method are not used in this case, although I don’t know where they would be used. Make sure to return null in the ExecutionError property and return <code>Microsoft.LightSwitch.ExecutionState.NotExecuted</code> for the ExecutionState. Of course you can add your own logic to determine whether the executable can be executed or handle the errors the way you like.</p><script src=https://gist.github.com/sschutten/faf8a8585079d2a425c35fabca3c4dd1.js></script><h2 id=implement-ishellcommand>Implement IShellCommand</h2><p>Now we have a class that implements <code>IExecutable</code>, we need to create a button through which the user can execute it. A button is a class that implements the <code>IShellCommand</code> interface. It allows you to specify a description for the button as well as a name. The <code>ExecutableObject</code> needs to return a new instance of the MyExecutableObject we just created. Furthermore, to be able to use the button, we need to make sure it’s enabled and visible. To create the button, create a new class named ‘MyCommand’ and implement the <code>IShellCommand</code> interface. Make sure to change all property and method bodies to do something and not throw an <code>NotImplementedException</code>.</p><script src=https://gist.github.com/sschutten/9ff968e413847bf1a0c9e7dd02c41b06.js></script><p>You can specify an image for the button by returning a <code>BitmapImage</code> using an image resource. For this you add an image to the Resources folder of the Client project. Then you use the following piece of code to return the image.</p><script src=https://gist.github.com/sschutten/1f8b5fe29193eaeff174fcb4e06fd7ff.js></script><h2 id=implement-ishellcommandgroup>Implement IShellCommandGroup</h2><p>As of the time of writing I don’t know how to add a custom button to the built-in Data button group, so we’ll create our own group to host our button. We create a new button group by creating a new class that implements the <code>IShellCommandGroup</code> interface. This interface lives in the <code>Microsoft.LightSwitch.Runtime.Shell.ViewModels.Commands</code> namespace, so make sure to add a using for it.</p><p>Implement the interface by right clicking the interface and choosing ‘Implement Interface’. It will generate three properties for you: Commands, DisplayName and Name. Replace the getters of the DisplayName and Name to return the names you’d like to use for your command. The commands property returns a collection of the commands available in the group. In this case we only return our MyCommand. You can construct a collection or use the ‘yield’ keyword as in the example below.</p><script src=https://gist.github.com/sschutten/44715d8972047bf2dc6af0cf473cb99a.js></script><h2 id=implement-ishellcommandgroupprovider>Implement IShellCommandGroupProvider</h2><p>You now created you executable, the button and the group. The last thing to do is make sure Lightswitch know about it, so it can add it to the ribbon. To do this, we use a class that implements the <code>IShellCommandGroupProvider</code> class. Create a new class named MyGroupProvider and imlement the <code>IShellCommandGroupProvider</code> interface. Make sure the GetShellCommandGroups method returns the MyGroup class, since that is the group we want to make available to the Lightswitch application.</p><p>To allow the Lightswitch application to discover the group provider, add an Export attribute to MyGroupProvider class with parameter <code>typeof(IShellCommandGroupProvider)</code>. The Export attribute is a way for MEF to export definitions in your class library or application, which can be imported elsewhere using an Import attribute. MEF scans the application for all Export attributes and makes them available. The parameter for the Export attribute allows MEF to create filters on the import, so that only particular types are imported. The Lightswitch application imports types that implement the <code>IShellCommandGroupProvider</code> and knows what to do with it. This way Lightswitch can discover our command groups and add them to the ribbon.</p><script src=https://gist.github.com/sschutten/880632cb54042ee9b5b93823e1b6f718.js></script><p>Now if you run your application you’ll see your button added to the ribbon. Once this is working, you can continue to modify the properties of your button, group and executable to do what you want.</p><p><a href=images/image5.png><img src=images/image5.png alt=image title=image></a></p></div><div class=btn-improve-page><a href=https://github.com/sschutten/blog/edit/master/content/posts/2011/08/lightswitch-custom-ribbon-button/index.md target=_blank><i class="fas fa-code-branch"></i>
Improve this page</a></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/2012/09/preparing-for-70-484-essentials-of-developing-windows-metro-style-apps-using-c/ class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>Preparing for 70-484: Essentials of Developing Windows Metro style Apps using C#</div></a></div><div class="col-md-6 next-article"><a href=/posts/2011/07/windows-phone-7-mango-features/ class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>Windows Phone 7 Mango features</div></a></div></div><hr><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="does-not-exist",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#extending-lightswitch-applications>Extending Lightswitch applications</a><ul><li><a href=#heading></a></li></ul></li><li><a href=#adding-a-class-file-to-the-lighswitch-application>Adding a class file to the Lighswitch application</a></li><li><a href=#steps-to-add-a-custom-button>Steps to add a custom button</a></li><li><a href=#implement-iexecutable>Implement IExecutable</a></li><li><a href=#implement-ishellcommand>Implement IShellCommand</a></li><li><a href=#implement-ishellcommandgroup>Implement IShellCommandGroup</a></li><li><a href=#implement-ishellcommandgroupprovider>Implement IShellCommandGroupProvider</a></li></ul></nav></div></div></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=/#recent-posts>Recent Posts</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><span>Email:</span> <span>sander@dotnetstudio.nl</span></li><li><span>Phone:</span> <span>+31 6 3830 4494</span></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hossainemruz/toha target=_blank><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">Copyright © 2021</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script>
<script type=text/javascript src=/js/popper.min.js></script>
<script type=text/javascript src=/js/bootstrap.min.js></script>
<script type=text/javascript src=/js/navbar.js></script>
<script type=text/javascript src=/js/plyr.js></script>
<script type=text/javascript src=/js/main.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script>
<script src=/js/single.js></script>
<script>hljs.initHighlightingOnLoad()</script></body></html>