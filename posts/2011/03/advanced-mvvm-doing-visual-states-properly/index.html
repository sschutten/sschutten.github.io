<!doctype html><html><head><title>Advanced MVVM: Doing visual states properly</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><link rel=icon type=image/png href=/images/favicon_hu71cff7c6f06c0ce56c441b69c0864ea6_5216_42x0_resize_box_3.png><link rel=stylesheet href=/css/style.css><meta name=description content="Advanced MVVM: Doing visual states properly"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-xxxxxxxx","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/main-logo_hu71cff7c6f06c0ce56c441b69c0864ea6_5216_42x0_resize_box_3.png alt=Logo>Sander Schutten's Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div><img src=/images/main-logo_hu71cff7c6f06c0ce56c441b69c0864ea6_5216_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/inverted-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=https://sschutten.github.io/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-plus-circle"></i><a href=/posts/2019/>2019</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2019/10/>October</a><ul><li><a href=/posts/2019/10/difference-between-apply-to-each-and-for-each-actions/>Difference between Apply to each and For each actions</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2019/09/>September</a><ul><li><a href=/posts/2019/09/intelligent-digital-assitants/>Intelligent chatbots for Microsoft Teams</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2019/08/>August</a><ul><li><a href=/posts/2019/08/edge-multi-profile-with-custom-images/>Custom profile images in Edge</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2018/>2018</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2018/02/>February</a><ul><li><a href=/posts/2018/02/logic-apps-improvement-suggestions/>Logic Apps improvement suggestions</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2018/12/>December</a><ul><li><a href=/posts/2018/12/connect-azure-ad-authenticated-signalr-hub-from-spfx/>Connect to Azure AD secured SignalR Hub from your SPFx code</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2017/>2017</a><ul><li><a href=/posts/2017/11/>November</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2013/>2013</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2013/06/>June</a><ul><li><a href=/posts/2013/06/move-your-development-vm-to-azure/>Move your development VM to Azure</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2012/>2012</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2012/09/>September</a><ul><li><a href=/posts/2012/09/preparing-for-70-484-essentials-of-developing-windows-metro-style-apps-using-c/>Preparing for 70-484: Essentials of Developing Windows Metro style Apps using C#</a></li><li><a href=/posts/2012/09/preparing-for-70-485-advanced-metro-style-app-development-using-c/>Preparing for 70-485: Advanced Metro style App Development using C#</a></li></ul></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/2011/>2011</a><ul class=active><li><i class="fas fa-plus-circle"></i><a href=/posts/2011/08/>August</a><ul><li><a href=/posts/2011/08/lightswitch-custom-ribbon-button/>Lightswitch: custom ribbon button</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2011/07/>July</a><ul><li><a href=/posts/2011/07/windows-phone-7-mango-features/>Windows Phone 7 Mango features</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2011/04/>April</a><ul><li><a href=/posts/2011/04/mix11-boot-camps/>MIX11: Boot Camps</a></li><li><a href=/posts/2011/04/mix11-day-1/>MIX11: Day 1</a></li><li><a href=/posts/2011/04/mix11-day-2/>MIX11: Day 2</a></li><li><a href=/posts/2011/04/mix11-day-3/>MIX11: Day 3</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/2011/03/>March</a><ul class=active><li><a class=active href=/posts/2011/03/advanced-mvvm-doing-visual-states-properly/>Advanced MVVM: Doing visual states properly</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2011/01/>January</a><ul><li><a href=/posts/2011/01/using-the-sync-framework-on-windows-phone-7/>Using the Sync Framework on Windows Phone 7</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2010/>2010</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2010/11/>November</a><ul><li><a href=/posts/2010/11/wcf-ria-services-odata-endpoint-does-not-support-update-or-linq/>WCF RIA Services OData endpoint does NOT support update or LINQ</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2010/12/>December</a><ul><li><a href=/posts/2010/12/building-a-location-aware-windows-phone-7-application-2/>Building a location aware Windows Phone 7 application</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2009/>2009</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2009/01/>January</a><ul><li><a href=/posts/2009/01/mce-guide-editor-source-code/>MCE Guide Editor source code</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2008/>2008</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2008/11/>November</a><ul><li><a href=/posts/2008/11/building-vista-media-center-add-ins-dutch/>Building Vista Media Center Add-ins (Dutch)</a></li><li><a href=/posts/2008/11/honk-twice-if-you-see-us/>Honk twice if you see us!</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2008/10/>October</a><ul><li><a href=/posts/2008/10/better-wssf-solution-structure/>Better WSSF solution structure</a></li><li><a href=/posts/2008/10/consume-wcf-service-using-sharepoint-designer/>Consume WCF service using Sharepoint Designer</a></li><li><a href=/posts/2008/10/day-0-arrived-in-la/>Day 0: arrived in LA</a></li></ul></li><li><a href=/posts/2008/09/>September</a></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2008/08/>August</a><ul><li><a href=/posts/2008/08/first-release-of-viddlernet/>First release of Viddler.Net</a></li><li><a href=/posts/2008/08/viddlernet-on-codeplex/>Viddler.Net on Codeplex</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2008/07/>July</a><ul><li><a href=/posts/2008/07/biztalk-server-capabilities-poster/>BizTalk Server capabilities poster</a></li><li><a href=/posts/2008/07/bizunit-designer/>BizUnit Designer</a></li><li><a href=/posts/2008/07/control-windows-media-center-with-new-windows-sideshow-beta-gadgets/>Control Windows Media Center with New Windows SideShow BETA Gadgets</a></li><li><a href=/posts/2008/07/ext-js/>Ext JS</a></li><li><a href=/posts/2008/07/farpoint-spread-for-biztalk-server-2006/>FarPoint Spread for BizTalk Server 2006</a></li><li><a href=/posts/2008/07/first-look-at-wcf-adapter-for-biztalk-server-2006-r2/>First look at WCF Adapter for BizTalk Server 2006 R2</a></li><li><a href=/posts/2008/07/86/>Home Server campaign</a></li><li><a href=/posts/2008/07/84/>How-To: New ASP.NET 3.5 Extensions Video Screencasts</a></li><li><a href=/posts/2008/07/map-xsstring-to-xsdatetime/>Map xs:string to xs:datetime</a></li><li><a href=/posts/2008/07/microsoft-biztalk-server-performance-optimization-guide/>Microsoft BizTalk Server Performance Optimization Guide</a></li><li><a href=/posts/2008/07/microsoft-loadgen-2007/>Microsoft LoadGen 2007</a></li><li><a href=/posts/2008/07/more-biztalk-posters/>More BizTalk posters</a></li><li><a href=/posts/2008/07/released-biztalk-server-2006-extentions-for-wf/>Released: BizTalk Server 2006 extentions for WF</a></li><li><a href=/posts/2008/07/video-biztalk-services-explained/>Video: BizTalk Services Explained</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2008/04/>April</a><ul><li><a href=/posts/2008/04/biztalk-server-2006-r3-just-around-the-corner/>BizTalk Server 2006 R3 just around the corner</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2008/03/>March</a><ul><li><a href=/posts/2008/03/status-update-on-mce-guide-editor/>Status update on MCE Guide Editor</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2008/02/>February</a><ul><li><a href=/posts/2008/02/jonas-butt-the-new-it-talent/>Jonas Butt, the new IT-talent?</a></li><li><a href=/posts/2008/02/63/>Running</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2007/>2007</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2007/06/>June</a><ul><li><a href=/posts/2007/06/devdays-2007-were-you-there/>DevDays 2007, were you there?</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2007/05/>May</a><ul><li><a href=/posts/2007/05/first-release-of-mce-guide-editor/>First release of MCE Guide Editor</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2007/02/>February</a><ul><li><a href=/posts/2007/02/net-magazine-article-published-online/>.Net Magazine article published online</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2007/01/>January</a><ul><li><a href=/posts/2007/01/accessing-flat-file-content-in-orchestration/>Accessing flat file content in orchestration</a></li><li><a href=/posts/2007/01/biztalk-adapter-whitepaper/>BizTalk Adapter whitepaper</a></li><li><a href=/posts/2007/01/biztalk-shell-extension/>BizTalk shell extension</a></li><li><a href=/posts/2007/01/biztalk-troubleshooting-guide/>BizTalk Troubleshooting Guide</a></li><li><a href=/posts/2007/01/mcts-biztalk-server-2006/>MCTS BizTalk Server 2006</a></li><li><a href=/posts/2007/01/pipeline-testing-framework-for-bts06/>Pipeline Testing Framework for BTS06</a></li><li><a href=/posts/2007/01/playing-blog-tag/>Playing Blog-Tag</a></li><li><a href=/posts/2007/01/storing-configuration-inside-sso-database/>Storing configuration inside SSO database</a></li><li><a href=/posts/2007/01/using-bam-api-to-create-related-activities/>Using BAM API to create related activities</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2006/>2006</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2006/11/>November</a><ul><li><a href=/posts/2006/11/add-existing-project-from-web-drama/>Add existing project from web drama</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2006/03/>March</a><ul><li><a href=/posts/2006/03/developing-for-vista-media-center/>Developing for Vista Media Center</a></li><li><a href=/posts/2006/03/html-generator-stylesheet-for-biztalk-2004-maps/>HTML Generator Stylesheet for BizTalk 2004 Maps</a></li><li><a href=/posts/2006/03/increase-xslt-performance-by-using-xlskey/>Increase XSLT performance by using xls:key</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2006/02/>February</a><ul><li><a href=/posts/2006/02/biztalk-load-generation-utility-reloaded/>BizTalk Load Generation Utility reloaded</a></li><li><a href=/posts/2006/02/biztalk-performance-tester-released/>BizTalk Performance Tester released</a></li><li><a href=/posts/2006/02/devdays-7-8-march/>DevDays 7 &amp;amp; 8 March</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2006/01/>January</a><ul><li><a href=/posts/2006/01/happy-new-year/>Happy new year!</a></li><li><a href=/posts/2006/01/identify-node-type-in-xslt/>Identify node type in XSLT</a></li><li><a href=/posts/2006/01/suppress-xml-documentation-warnings-for-a-project/>Suppress XML documentation warnings for a project</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2005/>2005</a><ul><li><i class="fas fa-plus-circle"></i><a href=/posts/2005/11/>November</a><ul><li><a href=/posts/2005/11/access-message-properties-inside-custom-pipeline-component/>Access message properties inside custom pipeline component</a></li><li><a href=/posts/2005/11/biztalk-server-2006-ctm-released/>BizTalk Server 2006 CTM Released</a></li><li><a href=/posts/2005/11/biztalks-sexy-new-xslt-mapper/>BizTalk&amp;#039;s sexy new XSLT mapper</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2005/10/>October</a><ul><li><a href=/posts/2005/10/biztalk-2006-beta-1/>BizTalk 2006 Beta 1</a></li><li><a href=/posts/2005/10/bizunit-20-released/>BizUnit 2.0 released</a></li><li><a href=/posts/2005/10/joining-the-overloaded-web-log-community/>Joining the overloaded web-log community</a></li><li><a href=/posts/2005/10/workflow-designer-will-substitute-orchestration-designer-in-biztalk-vnext/>Workflow designer will substitute orchestration designer in BizTalk vNext</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2005/12/>December</a><ul><li><a href=/posts/2005/12/load-xmlschemas-from-biztalk-assembly/>Load XmlSchema&amp;#039;s from BizTalk assembly</a></li></ul></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://sschutten.github.io/images/default-hero.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/avatar.jpg alt="Author Image"><h5 class=author-name>Sander Schutten</h5><p>March 14, 2011</p></div><div class=title><h1>Advanced MVVM: Doing visual states properly</h1></div><div class=post-content id=post-content><p>An important plus of rich internet applications is the potential user experience you can achieve by applying UX patterns. A part of this is the visual states and their transitions. A visual state determines what the user interface looks like at a certain point in time and the transitions describe how the application moves from one visual state to the other, many times using animations to enhance the experience.</p><p><a href=images/image.png><img src=images/image_thumb.png alt=image title=image></a></p><p>The most obvious way when you’re unfamiliar with XAML is to change the visual state of an application by writing code to show or hide controls when events occur, like e.g. a button click. Besides that on many occasions it requires a considerable amount of code, it doesn’t fit properly with the Model-View-ViewModel pattern. Although the pattern doesn’t prevent you from writing code in the codebehind as long as it related to the View, the pattern encourages to do it as little as possible.</p><p>The next commonly seen approach from people that want to stick to the MVVM-believes is to show/hide controls by binding properties like Visibility and Opacity to the ViewModel. This works fine for simple visual states, but has a couple of downsides, such as hard to maintain when a lot of controls are part of the visual state change, no support for animations and lack of seperation between View and ViewModel.</p><p>The only real proper way of doing visual states with WPF or Silverlight (phone / desktop) is through the VisualState-property of controls and pages. Each visual state in the VisualStates-property has a set of deltas to the base visual state, like the change of opacity of a button to 100%. Each visual state can furthermore contain transitions to and from the state if required. You can write the XAML for the visual states and transitions by hand, but it’s more convenient to use Expression Blend for this. In Expression Blend there’s the States-tab on which you can create or edit the visual states of any control, even the default controls when using a custom template.</p><p>The process of creating visual states and transitions can be found on many places on the web. The difficulty, however, lies in triggering a visual state transition, which is done using the VisualStateHelper class from code in many of the examples you’ll find. If you’re doing MVVM this becomes cumbersome since you need to track the properties of the View and trigger the appropriate state changes from code.</p><p><a href=images/image1.png><img src=images/image_thumb1.png alt=image title=image></a>
This is where behaviors come into the picture. Expression Blend 4 comes packed with a couple of behaviors that make it easy to do visual state changes without writing a single line of code. These are:</p><ul><li>GoToStateAction</li><li>DataStateBehavior</li></ul><p>GoToStateAction calls the VisualStateHelper.GoToState() when an event occurs. To what state to transition and on what event can be configured. DataStateBehavior acts as an if-else statement. In your ViewModel you expose a boolean property determining the state of your application. You configure through data binding to inspect this property and what visual states the application should go to when the value is either true or false. E.g. you can use this behavior for hiding / showing controls depending on user rights. On your ViewModel you define for example a CanEdit property of type boolean and using the DataStateBehavior you switch between the ReadOnlyState and EditableState visual states.</p><p>When you want more functionality, there’s also the <a href=http://expressionblend.codeplex.com/>Expression Blend Samples</a>. Although the name suggests differently, the Expression Blend Samples contains some very mature additions to the default Blend behaviors and triggers. The package included the DataStateBehavior since Blend 3, which is now packed with Blend 4. The package also contains the DataStateSwitchBehavior, which, as its name suggests, acts like a switch statement. It’s basically the same as the DataStateBehavior, but with multiple possible values besides just true or false. To use this behavior you expose an enumeration property on your ViewModel and use the DataStateSwitchBehavior to switch to particular visual states for each of the enumeration values. You can use this for example with the application roles of your application, e.g. Guest, Contributor and Administrator.</p><script src=https://gist.github.com/sschutten/a0b2d616d114c7db0bf9c7149dc8e90b.js></script></div><div class=btn-improve-page><a href=https://github.com/sschutten/blog/edit/master/content/posts/2011/03/advanced-mvvm-doing-visual-states-properly/index.md target=_blank><i class="fas fa-code-branch"></i>
Improve this page</a></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/2011/04/mix11-boot-camps/ class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>MIX11: Boot Camps</div></a></div><div class="col-md-6 next-article"><a href=/posts/2011/01/using-the-sync-framework-on-windows-phone-7/ class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>Using the Sync Framework on Windows Phone 7</div></a></div></div><hr><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="does-not-exist",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents></nav></div></div></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=/#recent-posts>Recent Posts</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><span>Email:</span> <span>sander@dotnetstudio.nl</span></li><li><span>Phone:</span> <span>+31 6 3830 4494</span></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hossainemruz/toha target=_blank><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">Copyright © 2021</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script>
<script type=text/javascript src=/js/popper.min.js></script>
<script type=text/javascript src=/js/bootstrap.min.js></script>
<script type=text/javascript src=/js/navbar.js></script>
<script type=text/javascript src=/js/plyr.js></script>
<script type=text/javascript src=/js/main.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script>
<script src=/js/single.js></script>
<script>hljs.initHighlightingOnLoad()</script></body></html>