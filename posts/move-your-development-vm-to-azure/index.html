<!DOCTYPE html>
<html>
  <head>
    <title>Move your development VM to Azure</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />


<link rel="stylesheet" href="/assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="/assets/css/style.css" />
<link rel="stylesheet" href="/assets/css/navbar.css" />
<link rel="stylesheet" href="/css/style.css" />


<link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" />


<link rel="icon" type="image/png" href="/images/favicon.png" />


    
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css"
/>
<link rel="stylesheet" href="/assets/css/single.css" />


    
    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-xxxxxxxx', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    
  </head>

  <body>
    <div class="container-fluid bg-dimmed wrapper">
      
      
    <nav class="navbar navbar-expand-lg top-navbar final-navbar shadow">
    <div class="container">
      <a class="navbar-brand" href="/posts">
        <img src="/images/logo.png">Sander Schutten&#39;s Blog</a>
      <button class="navbar-toggler navbar-light" type="button" >
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="top-nav-items">
        <ul class="navbar-nav ml-auto">
        </ul>
      </div>
    </div>
</nav>



      
      
<div class="container p-0 read-area">
  
  <div class="hero-area col-sm-12" style='background-image: url(https://sschutten.github.io/assets/images/default-hero.jpg);'>
  </div>

  
  <div class="page-content">
    <div class="author-profile ml-auto align-self-lg-center">
      <img class="rounded-circle" src='/images/avatar.jpg'/>
      <h5 class="author-name">Sander Schutten</h5>
      <p>June 21, 2013</p>
    </div>

    <div class="title">
      <h1>Move your development VM to Azure</h1>
    </div>

    <div class="post-content" id="post-content">
      <p>During my day job I regularly had to use virtual machines to do my work on. It just simply isn&rsquo;t convenient to run BizTalk Server or SharePoint on you laptop. I&rsquo;ve used many types and brands of virtualisation software like Virtual PC, Virtual Server and VMWare. More recently I started using Hyper-V, which, because baked into Windows 8, sounds like a very natural thing to do.</p>
<p>Unfortunately, whatever software I used, the performance I get just doesn&rsquo;t provide a good user experience. Secondly, I&rsquo;m always juggling with these, sometime huges, VMs, transferring them to external hard drives, copying them etc. Lastly there&rsquo;s also the tradeof between portability and performance of the laptop/tablet I&rsquo;d like to use for my work and in order to run these VMs it requires quite a beefy machine.</p>
<p>All of these things made me dream of having the option to run my VMs in Azure, so I could access them from any device from anywhere. With the arrival of Azure&rsquo;s Infrastructure-as-a-service offering, this became a viable reality. With the <a href="http://blogs.msdn.com/b/sql_shep/archive/2013/06/10/azure-billing-per-minute-and-no-compute-charge-for-a-stopped-iaas-vm.aspx">recent announcement</a> that Azure billing will be per minute and you won&rsquo;t be billed for stopped VMs, I think the platform is ready and I decided to take the plunge.</p>
<h2 id="condiderations">Condiderations</h2>
<p>There are a few ways to have your development VM run in Azure:</p>
<ul>
<li>Create and configure the VM in Azure</li>
<li>Create a custom template and upload it to Azure</li>
<li>Copy an existing VHD to Azure</li>
</ul>
<p>Because I currently have VHDs on my machine that I just like to run as-in in Azure, I explored the latter option. I will describe in this post how you can do the same.</p>
<p><strong>Important</strong>: The newer VHDX format is not supported in Windows Azure. You need to convert the disk to VHD using Hyper-V Manager or the convert-cmdlet. My disk was already a VHD, so I don&rsquo;t have experience with this process.</p>
<h2 id="supported-os">Supported OS</h2>
<p>The list supported operating systems are either Windows Server 2008 R2 with SP1 (x64) or Windows Server 2012 (x64). Although I didn&rsquo;t find any writing of this I assume this is for creating the templates. I tried copying an existing Windows 7 VHDto Azure and it works just fine. I didn&rsquo;t try with any other operating systems yet, but I&rsquo;ll try Windows Server 2008 next.</p>
<h2 id="4-simple-steps">4 Simple Steps</h2>
<p>Copying an existing VHD to Azure proved to be easier than I thought, with the exception of uploading the VHD (more on that in a bit). Follow these steps for copying your VHD to Azure.</p>
<p>These steps assume you already have a working Hyper-V VHD available.</p>
<h3 id="step-1--create-a-storage-account">Step 1 – Create a storage account</h3>
<p>The VHDs are stored on Azure in a storage account. To create a new storage account, login to the <a href="https://manage.windowsazure.com/">Azure Portal</a> and click the big plus sign on the bottom and choose Data &gt; Storage &gt; Quick Create. Enter a valid name for the URL and choose a location that is most close to you.</p>
<p><a href="/images/uploads/2013/06/image.png"><img src="/images/uploads/2013/06/image_thumb.png" alt="image" title="image"></a></p>
<p>Once the storage account is created, locate it in the Azure Portal and click the Manage Access Keys button at the bottom. Take note of the primary access key, because we need it for the next step where we upload the VHD to this storage account.</p>
<p><a href="/images/uploads/2013/06/image1.png"><img src="/images/uploads/2013/06/image_thumb1.png" alt="image" title="image"></a></p>
<p>Next, go to the containers section of the storage account and create a new container. You can name it whatever you want.</p>
<h3 id="step-2--upload-the-vhd">Step 2 – Upload the VHD</h3>
<p>The next step is to upload the VHD to the storage account for it to be used in Azure. Note that uploading the VHD can take quite some time depending on the size of the VHD and your upload speed.</p>
<p>Uploading the VHD to Azure proved to be a bit of a challenge. First of all you need to make sure you upload the VHD as a <strong>page blob</strong>. It took me 12 hours of uploading to find that out. Then there are <a href="http://blogs.msdn.com/b/windowsazurestorage/archive/2010/04/17/windows-azure-storage-explorers.aspx">a lot of different third party storage explorers</a> available to manage your storage account, some of which don&rsquo;t support page blobs or only reading page blobs, not uploading them. I tried many of them and personally like <a href="http://clumsyleaf.com/products/cloudxplorer">CloudXplorer</a> the best. There&rsquo;s an evaluation version available that you can use.</p>
<p>After you installed CloudXplorer and start it for the first time, it&rsquo;ll ask you to add a new account. For the account details, use the name and primary key of your storage account, created in the previous step.</p>
<p>I found the upload to be more reliable when using more threads. You can increase the number of threads CloudXplorer uses for uploading by going to File &gt; Preferences. I&rsquo;ve configured mine with 4 threads, but you should play with it yourself. Increasing the number of threads can also increase your upload speed, if you have the bandwidth.</p>
<p><a href="/images/uploads/2013/06/image2.png"><img src="/images/uploads/2013/06/image_thumb2.png" alt="image" title="image"></a></p>
<p>To upload the VHD open the storage account node on the left and right-click the storage container. Choose &lsquo;Upload page blob&rsquo;, pick the VHD from your disk and get back to doing other stuff as this might take a while.</p>
<p><a href="/images/uploads/2013/06/image3.png"><img src="/images/uploads/2013/06/image_thumb3.png" alt="image" title="image"></a></p>
<p>Unfortunately I had occasions where the connection was dropped and I had to start the upload all over again. It should be possible to resume uploading, but for me that feature wasn&rsquo;t working.</p>
<h3 id="step-3--create-the-disk-in-azure">Step 3 – Create the disk in Azure</h3>
<p>OK, let&rsquo;s assume your upload finally finished, we can now create the disk in Azure to be used as a virtual machine. If you by accident didn&rsquo;t upload the VHD as a page blog, this is the step in the process where you get an error.</p>
<p>In order to create the disk, in the Azure Portal, navigate to Virtual Machines and go to the Disks tab. Click the create button at the bottom to create the disk. Give it a name and pick the VHD URL from the storage account where you uploaded the VHD to. Tell Azure that the VHD contains an operating system from the Windows operating system family.</p>
<p><a href="/images/uploads/2013/06/image4.png"><img src="/images/uploads/2013/06/image_thumb4.png" alt="image" title="image"></a></p>
<h3 id="step-4--creat-the-virtual-machine">Step 4 – Creat the virtual machine</h3>
<p>The only thing left to do is to create a virtual machine that uses the disk we just created. To create a new virtual machine, click the plus sign on the bottom and choose Compute &gt; Virtual Machine &gt; From Gallery.</p>
<p><a href="/images/uploads/2013/06/image5.png"><img src="/images/uploads/2013/06/image_thumb5.png" alt="image" title="image"></a></p>
<p>In the dialog that pops up, select My Disks and pick the disk we just created. Continue with the rest of the wizard and choose an appropriate virtual machine size and availability set (optional). Once you complete the virtual machine wizard, it will take a few minutes for Azure to create the virtual machine and start it. It can take a bit of time once the virtual machine is started before Remote Desktop Services are running and you&rsquo;ll be able to connect to it.</p>
<h2 id="final-words">Final words</h2>
<p>Now that you have your virtual machine running in Azure, don&rsquo;t forget to turn it off if you don&rsquo;t use it to prevent you from getting charged. This way you can have a fairly large VM with excellent performance, but still limit your costs.</p>

    </div>

    
    
      <div class="btn-improve-page">
          <a href="https://github.com/hossainemruz/toha-example-site/edit/master/content/posts%5cmove-your-development-vm-to-azure.md">
            <i class="fas fa-code-branch"></i>
            Improve This Page
          </a>
      </div>
    

    
  <hr />
    <div class="row next-prev-navigator">


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
      
      <div class="col-md-6 previous-article">
        <a href="/posts/logic-apps-improvement-suggestions/" class="btn btn-outline-info">
          <span><i class="fas fa-chevron-circle-left"></i> Prev</span>
          <br />
          <span>Logic Apps improvement suggestions</span>
        </a>
      </div>
      
    
    
      
        
        
          
              
          
        
        <div class="col-md-6 next-article">
          <a href="/posts/preparing-for-70-485-advanced-metro-style-app-development-using-c/" class="btn btn-outline-info">
            <span>Next <i class="fas fa-chevron-circle-right"></i></span>
            <br />
            <span>Preparing for 70-485: Advanced Metro style App Development using C#</span>
          </a>
        </div>
      
    
  

  

  

  

  

</div>

  <hr />
  
  
      <div id="disqus_thread"></div>
<script type="text/javascript">
  (function () {
    
    
    if (window.location.hostname == "localhost") return;

    var dsq = document.createElement("script");
    dsq.type = "text/javascript";
    dsq.async = true;
    var disqus_shortname = "does-not-exist";
    dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
    (
      document.getElementsByTagName("head")[0] ||
      document.getElementsByTagName("body")[0]
    ).appendChild(dsq);
  })();
</script>
<noscript
  >Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript"
    >comments powered by Disqus.</a
  ></noscript
>
<a href="https://disqus.com/" class="dsq-brlink"
  >comments powered by <span class="logo-disqus">Disqus</span></a
>

  
</div>

    </div>

    <footer class="container-fluid text-center align-content-center footer pb-2">
  <div class="container pt-5">
    <div class="row text-left">
      <div class="col-md-4 col-sm-12">
        <h5>Navigation</h5>
        
        <ul>
            
            <li class="nav-item">
              <a class="smooth-scroll" href="#recent-posts">Recent Posts</a>
            </li>
            
        </ul>
        

      </div>
      <div class="col-md-4 col-sm-12">
        <h5>Contact Me</h5>
        <ul>
          
          <li><span>Email: </span> <span>sander@dotnetstudio.nl</span></li>
          
          <li><span>Phone: </span> <span>&#43;31 6 3830 4494</span></li>
          
        </ul>
      </div>
      <div class="col-md-4 col-sm-12">
        
      </div>
    </div>
  </div>
  <hr />
  <div class="container">
    <div class="row text-left">
      <div class="col-md-4">
        <a id="theme" href="https://github.com/hossainemruz/toha" target="#">
          <img src="/assets/images/logo-inverted.png">
          Toha
        </a>
      </div>
      <div class="col-md-4">Copyright © 2020</div>
      <div class="col-md-4">
        
      </div>
    </div>
  </div>
</footer>

    <script src="/assets/js/jquery-3.4.1.min.js"></script>
<script src="/assets/js/bootstrap.min.js"></script>

<script src="/assets/js/navbar.js"></script>
<script src="/assets/js/jquery.filterizr.min.js"></script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
<script src="/assets/js/single.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>


  </body>
</html>
